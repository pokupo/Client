var StatusPaymentWidget=function(){function t(){o(),i(),e()}function e(){var t=r.GetInputParameters("statusPayment");$.isEmptyObject(t)||(d=r.UpdateSettings1(d,t)),Config.StatusPayment=d}function a(){r.ClearContainer(d)}function n(){r.InsertContainer(d)}function i(){if("status_payment"==Routing.route){var t=$.cookie(Config.Base.cookie.orderId),e=$.cookie(Config.Base.cookie.userEmail);if(t){var a=Routing.GetParameter("name"),n=Routing.GetParameter("status");n&&(a=a+"/"+n);var i=a+"/?"+t+"&mailUser="+e;r.BaseLoad.Tmpl(d.tmpl,function(){r.BaseLoad.StatusPayment(i,function(t){r.BaseLoad.ShopInfo(function(e){s(t,e)})})})}else r.WidgetLoader(!0,d.container),alert("Нет параметров инициализации!")}else r.WidgetLoader(!0,d.container)}function o(){r.AddEvent("w.change.route",function(){i()}),r.AddEvent("StatusPaymentWidget.update",function(){i()})}function s(t,e){var a=new StatusPaymentViewModel(t,e,d);n(),u(a)}function u(t){r.RenderTemplate(t,d,null,function(t){n(),u(t)},function(){a()})}var r=this;r.widgetName="StatusPaymentWidget",r.version=1,r.minWidgetVersion=1,r.maxWidgetVersion=2,r.minTmplVersion=1,r.maxTmplVersion=2,r.InitWidget=t;var d={container:{widget:"statusPaymentWidgetId",def:"defaultStatusPaymentWidgetId"},tmpl:{path:"statusPaymentTmpl.html",id:"statusPaymentPageTmpl"},animate:"function"==typeof AnimateStatusPayment?AnimateStatusPayment:null,status:null,backUrl:""}},StatusPaymentViewModel=function(t,e,a){function n(t){var e=this;e.label=ko.observable(t.label),e.value=ko.observable(t.value),e.help=ko.observable(t.help)}var i=this;i.orderId=t.id_order,i.instruction=t.instruction,i.cssOrder="order_print_block",i.status=t.status,i.isPaid=ko.observable(!1),"paid"==i.status&&i.isPaid(!0),i.isWait=ko.observable(!1),"wait_pay"==i.status&&i.isWait(!0),i.isCancel=ko.observable(!1),"cancel"==i.status&&i.isCancel(!0),i.isBack=ko.observable(!1),"back"==i.status&&i.isBack(!0),i.outData=ko.observableArray(),$.each(t.out_data,function(e){i.outData.push(new n(t.out_data[e]))}),i.egoods=[],t.egoods&&($.each(t.egoods,function(e){t.egoods[e].max_upload||(t.egoods[e].max_upload=!1),t.egoods[e].expiration||(t.egoods[e].expiration=!1)}),i.egoods=t.egoods),i.Print=function(t){var e=window.open();e.document.write($("#"+t).html()),e.print(),e.close()},i.ClickPrintOrder=function(){i.Print(i.cssOrder)},i.ClickBack=function(){var t=e.site_shop;a.backUrl&&(t=a.backUrl),window.location.href=t},i.ClickRefresh=function(){EventDispatcher.DispatchEvent("StatusPaymentWidget.update")},i.showRefresh=!1,"success"==Routing.GetParameter("status")&&"wait_pay"==i.status&&(i.showRefresh=!0)},TestStatusPayment={Init:function(){if("function"==typeof Widget){StatusPaymentWidget.prototype=new Widget;var t=new StatusPaymentWidget;t.Init(t)}else setTimeout(function(){TestStatusPayment.Init()},100)}};TestStatusPayment.Init();