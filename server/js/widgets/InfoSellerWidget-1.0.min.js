window.InfoSellerWidget=function(){function e(){n(),Loader.IsReady()&&(Loader.InsertContainer(s.container),t())}function o(e){var o=e.options.params;s.tmpl=Config.InfoSeller.tmpl,s.container=e.element;var t={};"object"==Config.Base.sourceParameters&&"undefined"!=typeof WParameters&&WParameters.infoSeller&&(t=WParameters.infoSeller),$.isEmptyObject(t)||t.animate&&(s.animate=t.animate);for(var n in o)"tmpl"==n&&o.tmpl?(o.tmpl.path&&(s.tmpl.path=o.tmpl.path),o.tmpl.id&&(s.tmpl.id=o.tmpl.id)):"uniq"==n&&o.uniq?s.hash=o.uniq:"show"==n&&o.show?s.show=o.show:s.infoSeller[n]=o[n];a.settings=s,Parameters.cache.infoSellerCollection[o.uniq]=!0}function t(){a.BaseLoad.Tmpl(s.tmpl,function(){$.each(Parameters.cache.infoSellerCollection,function(e){EventDispatcher.DispatchEvent("ISeller.tmpl."+e),delete Parameters.cache.infoSellerCollection[e]})})}function n(){EventDispatcher.AddEventListener("w.ready",function(){t()}),EventDispatcher.AddEventListener("ISeller.tmpl."+s.hash,function(){s.infoSeller.data?(l(),p(s.infoSeller.data)):window.console&&console.log("No data on the Seller")})}function i(){var e=$(s.container).find(a.SelectCustomContent().join(", ")).clone();$(s.container).empty().html(e)}function l(){i(),$(s.container).append($("script#"+a.GetTmplName()).html())}function p(e){var o=new InfoSellerViewModel(e,s.show);r(o)}function r(e){try{ko.cleanNode($(s.container).children()[0]),ko.applyBindings(e,$(s.container).children()[0]),"function"==typeof AnimateInfoSeller&&new AnimateInfoSeller,s.animate&&s.animate()}catch(o){a.Exception("Ошибка шаблона ["+a.GetTmplName()+"]",o),s.tmpl.custom?(delete s.tmpl.custom,a.BaseLoad.Tmpl(s.tmpl,function(){l(),r(e)})):i()}}var a=this;a.widgetName="InfoSellerWidget",a.version=1,a.minWidgetVersion=1,a.maxWidgetVersion=2,a.minTmplVersion=1,a.maxTmplVersion=2,a.SetParameters=o,a.InitWidget=e;var s={tmpl:{},animate:null,container:null,infoSeller:{},hash:null,show:{blockShop:!0,blockInfoSeller:!1}}};var InfoSellerViewModel=function(e,o){var t=this,n=e.seller,i=e.shop;t.show={blockShop:o.blockShop,blockInfoSeller:o.blockInfoSeller},t.sellerId=n.id,t.nameSeller=n.name_seller,t.websiteSeller=n.website,t.shopId=i.id,t.nameShop=i.name_shop,t.emailLinkTitle=i.email_support,t.mailtoShop="mailto:"+t.emailLinkTitle,t.phonesSupportShop=ko.observable(),i.phones_support&&o.blockShop&&t.phonesSupportShop(i.phones_support),t.siteSupportShop=ko.observable(),i.site_support&&o.blockShop&&t.siteSupportShop(i.site_support),t.siteLinkTitle=ko.computed(function(){var e="";return t.siteSupportShop()&&(e=t.siteSupportShop().replace("http://",""),e=e.replace("https://","")),e},this),t.skypeSupportShop=ko.observable(),i.skype_support&&o.blockShop&&t.skypeSupportShop(i.skype_support),t.icqSupportShop=ko.observable(),i.icq_support&&o.blockShop&&t.icqSupportShop(i.icq_support),t.ratingShop=i.rating_shop,t.positiveOpinion=i.positive_opinion,t.negativeOpinion=i.negative_opinion,t.useCart=i.use_cart,t.routeLogoShop=i.route_logo_shop,t.allGoods=i.all_goods,t.operators=e.operator,t.ClickOperator=function(){}};