var JSSettings={shopId:0,protocolHTTP:"https://",protocolHTTPS:"https://",host:"server.pokupo.ru/prod/server/",pathToJS:"js/",pathToTmpl:"pokupo.ru/themes/",theme:"default",pathToData:"prod/server/services/DataProxy.php?query=",pathToPostData:"prod/server/services/DataPostProxy.php",pathToCore:"index.html",pathToPostCore:"postData.html",hostApi:"api.pokupo.ru/",catalogPathApi:"catalog/",goodsPathApi:"goods/",userPathApi:"user/",cartPathApi:"cart/",favPathApi:"fav/",geoPathApi:"geo/",shopPathApi:"shop/",orderPathApi:"order/",paymentPathApi:"payment/",messagePathApi:"message/",dev:false,sourceData:"api",devScripts:["easyXDM.min.js","knockout-3.2.0.js","jquery.cookie.js","jquery.textchange.min.js","widgets/Config-1.1.js","widgets/Routing-1.0.js","widgets/Paging-1.0.js","widgets/Widget-1.1.js","promo/widgets.animate.min.js"],scripts:["promo/pokupo.components.min.js","widgets/pokupo.widgets.lib.min.js","promo/pokupo.widgets.animate.min.js"],styles:["https://pokupo.ru/assetic/css/compiled/theme.min.css"],inputParameters:{}};var EventDispatcher={events:[],AddEventListener:function(a,b){this.events[a]=this.events[a]||[];if(this.events[a]){this.RemoveEventListener(a,b);this.events[a].push(b)}},RemoveEventListener:function(d,e){if(this.events[d]){var c=this.events[d];var a=EventDispatcher.HashCode(e.toString());for(var b=c.length-1;b>=0;--b){if(EventDispatcher.HashCode(c[b].toString())===a){c.splice(b,1);return true}}}return false},DispatchEvent:function(c,d){if(this.events[c]){var b=this.events[c],a=b.length;while(a--){b[a](d)}}},HashCode:function(d){var c=0,a,b;if(d.length==0){return c}for(a=0;a<d.length;a++){b=d.charCodeAt(a);c=((c<<5)-c)+b;c=c&c}return c},GetUUID:function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=Math.random()*16|0,b=e=="x"?d:(d&3|8);return b.toString(16)});return a}};var JSLoader={loaded:false,loadedCount:0,pathToJs:null,Init:function(a,b){this.pathToJs=b;JSLoader.Load(a,function(){JSLoader.RegisterLoaded(a)})},RegisterLoaded:function(a){JSLoader.loadedCount=JSLoader.loadedCount+1;if(JSLoader.loadedCount==a.length){JSLoader.OnReady()}},OnReady:function(){if(typeof ko=="object"){JSLoader.loaded=true;EventDispatcher.DispatchEvent("onload.scripts")}else{setTimeout(function(){JSLoader.OnReady()},100)}},Load:function(a,f,b){var e=document.getElementsByTagName("head")[0]||document.documentElement;for(var d in a){var c=document.createElement("script");c.async=true;c.type="text/javascript";if(b){c.src=b+a[d]}else{c.src=this.pathToJs+a[d]}c.async=true;if(c.readyState){c.onreadystatechange=function(){if(c.readyState=="loaded"||c.readyState=="complete"){c.onreadystatechange=null;f()}}}else{c.onload=function(){if(f){c.onload=f()}}}e.appendChild(c)}},LoadCss:function(c){var b=document.getElementsByTagName("head")[0]||document.documentElement;for(var a in c){var d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=c[a];b.appendChild(d)}}};var JSCore={version:1.2,isReady:false,shopId:null,dev:false,Init:function(a){if(document.location.protocol=="https:"){JSSettings.protocolHTTP=JSSettings.protocolHTTPS}JSCore.SetInputParameters(a);JSLoader.pathToJs=JSSettings.protocolHTTP+JSSettings.host+JSSettings.pathToJS;JSCore.shopId=JSSettings.shopId;XDMTransport.Init(JSSettings.host+JSSettings.pathToCore);JSCore.isReady=true},ParserInputParameters:function(g){var f={};var e=document.getElementsByTagName("script");var a="";for(var c=0;c<=e.length-1;c++){if(e[c].hasAttribute("src")){a=e[c].getAttributeNode("src").value;if(g.test(a)){break}}}if(a){var b=a.split("?");if(b.length>1){var d=b[1].split("&");for(var c=0;c<=d.length-1;c++){var h=d[c].split("=");f[h[0]]=h[1]}}}if(f){return f}return null},SetInputParameters:function(c){var a=JSCore.ParserInputParameters(/JSCore/);if(Object.keys(a).length==0){a=JSCore.ParserInputParameters(/pokupo.widgets.[a-z0-9]{32}.min.js/)}if(a){for(var b in a){if(JSSettings.hasOwnProperty(b)){JSSettings[b]=a[b]}}}if(typeof WParameters!=="undefined"&&WParameters.core){for(var b in WParameters.core){if(JSSettings.hasOwnProperty(b)){JSSettings[b]=WParameters.core[b]}}}if(c){for(var b in c.core){if(JSSettings.hasOwnProperty(b)){JSSettings[b]=c.core[b]}}}JSSettings.inputParameters=c;JSSettings.inputParameters.shopId=JSSettings.shopId}};var XDMTransport={remote:"",event:{},Init:function(a){XDMTransport.remote=a},GetProtocol:function(a){if(a){return JSSettings.protocolHTTPS}else{return JSSettings.protocolHTTP}},EventExecute:function(b,a){$.each(XDMTransport.event[a],function(c){XDMTransport.event[a][c](b)});delete XDMTransport.event[a]},Load:{FromProxy:function(b){if(typeof easyXDM!=="undefined"){var a=new easyXDM.Socket({remote:XDMTransport.GetProtocol(b.protocol)+XDMTransport.remote,onMessage:function(c){if(b.callback){b.callback(c)}}});a.postMessage(JSSettings.pathToData+b.url)}else{setTimeout(function(){XDMTransport.Load.FromProxy(b)},1000)}},FromApi:function(a){$.ajax({type:"GET",async:true,url:decodeURIComponent(a.url),dataType:a.type,success:function(b){if(a.callback){a.callback(b)}}})},Tmpl:function(b,c){var a=XDMTransport.GetProtocol()+JSSettings.pathToTmpl+JSSettings.theme+"/tmpl/"+b;if(/^(https?|ftp)\:\/\/(www\.)?([a-zA-Z0-9\.\-]+\.[a-z]{2,})(\/.+)$/.test(b)){a=b}XDMTransport.Load.FromProxy({url:a,callback:c,protocol:null})},Data:function(a,d,c){c=JSSettings.protocolHTTPS;var b=EventDispatcher.HashCode(a+d.toString());if(XDMTransport.event[b]==undefined){XDMTransport.event[b]=[]}XDMTransport.event[b].push(d);if(XDMTransport.event[b].length==1){if(JSSettings.sourceData=="api"){XDMTransport.Load.FromApi({type:"jsonp",url:decodeURIComponent(a),callback:function(e){XDMTransport.EventExecute(e,b)}})}if(JSSettings.sourceData=="proxy"){XDMTransport.Load.FromProxy({url:a,protocol:c,callback:function(e){XDMTransport.EventExecute(JSON.parse(e),b)}})}}},DataPost:function(b,c){if(typeof easyXDM!=="undefined"){var a=new easyXDM.Rpc({remote:XDMTransport.GetProtocol(c)+JSSettings.host+JSSettings.pathToPostCore,onReady:function(){b.attr("action",XDMTransport.GetProtocol(c)+JSSettings.host+JSSettings.pathToPostData);b.submit()}},{local:{returnUploadResponse:function(d){EventDispatcher.DispatchEvent(EventDispatcher.HashCode(b.toString()),JSON.parse(d.msg))}}})}else{setTimeout(function(){XDMTransport.Load.DataPost(b,c)},1000)}}}};var Logger={Console:{Exception:function(b,d,c){console&&console.log("Exception : "+new Date()+" : "+b+" : "+d);if(c){var a="";if(c.message){a+=c.message}if(c.stack){a+=" | stack: "+c.stack}console&&console.log(a)}},Info:function(a,b){console&&console.log("Info : "+new Date()+" : "+a+" : "+b)},VarDump:function(b,a,c){console&&console.log("Var Dump : "+b+" : "+a);console&&console.log(c)}}};var PokupoWidgets={model:{order:"widgets/OrderViewModel-1.0.min.js",auth:"widgets/AuthenticationViewModel-1.1.min.js",menu:"widgets/MenuPersonalCabinetWidget-1.1.js",content:"widgets/ContentViewModel-1.0.min.js",goods:"widgets/GoodsViewModel-1.0.min.js",registration:"widgets/RegistrationViewModel-1.0.min.js"},list:{all:"widgets/pokupo.widgets.min.js",authentication:"widgets/AuthenticationWidget-1.1.min.js",cart:"widgets/CartWidget-1.0.min.js",catalog:"widgets/CatalogWidget-1.0.min.js",breadCrumb:"widgets/BreadCrumbWidget-1.0.min.js",buttonPayment:"widgets/ButtonPaymentWidget-1.1.min.js",content:"widgets/ContentWidget-1.1.min.js",cartGoods:"widgets/CartGoodsWidget-1.0.min.js",cabinetCartGoods:"widgets/CabinetCartGoodsWidget-1.0.min.js",favorites:"widgets/FavoritesWidget-1.0.min.js",goods:"widgets/GoodsWidget-1.2.min.js",infoSeller:"widgets/InfoSellerWidget-1.0.min.js",menuPersonalCabinet:"widgets/MenuPersonalCabinetWidget-1.1.min.js",message:"widgets/MessageWidget-1.0.min.js",order:"widgets/OrderWidget-1.1.min.js",orderList:"widgets/OrderListWidget-1.0.min.js",profile:"widgets/ProfileWidget-1.0.min.js",registration:"widgets/RegistrationWidget-1.0.min.js",registrationSeller:"widgets/RegistrationSellerWidget-1.0.min.js",relatedGoods:"widgets/RelatedGoodsWidget-1.0.min.js",search:"widgets/SearchWidget-1.0.min.js",searchResult:"widgets/SearchResultWidget-1.1.min.js",userInformation:"widgets/UserInformationWidget-1.1.min.js",standaloneGoods:"widgets/StandaloneGoodsWidget-1.0.min.js",standalonePayment:"widgets/StandalonePaymentWidget-1.0.min.js",statusPayment:"widgets/StatusPaymentWidget-1.0.min.js",modalMessage:"widgets/ModalMessageWidget-1.0.min.js",shopInfo:"widgets/ShopInfoWidget-1.0.min.js"},libs:{ya:{path:"//yandex.st/share/",name:"share.js"}},Init:function(a,b){JSCore.Init(b);JSLoader.Load([PokupoWidgets.libs.ya.name],function(){if(typeof jQuery=="undefined"){JSLoader.Load(["jquery-1.11.2.js"],function(){PokupoWidgets.Load(a)})}else{PokupoWidgets.Load(a)}},PokupoWidgets.libs.ya.path)},Load:function(c){var a=JSSettings.scripts;if(JSSettings.dev){a=JSSettings.devScripts}JSLoader.LoadCss(JSSettings.styles);EventDispatcher.AddEventListener("onload.scripts",function(){if(PokupoWidgets.TestAll(c)){JSLoader.Load([PokupoWidgets.list.all])}else{for(var d in c){var e=PokupoWidgets.list[c[d]];if(e){JSLoader.Load([e])}}}});for(var b in a){JSLoader.Load([a[b]],JSLoader.RegisterLoaded(a))}},TestAll:function(b){for(var a=0;a<=b.length-1;a++){if(b[a]=="all"){return true}}return false}};